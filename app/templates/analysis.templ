package templates

import "fmt"
import "strings"

templ Analysis(userHandle string, allSentiments []string, prevailingSentiment string, averageConfidenceScore float64) {
    <div class="card bg-base-100 shadow-xl w-full max-w-2xl">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">Sentiment Analysis Results</h2>
            
            <div class="flex items-center gap-2 mb-6">
                <span class="text-gray-600">User:</span>
                <span class="badge badge-primary badge-lg">{ userHandle }</span>
            </div>
            
            <div class="divider"></div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="stat bg-base-200 rounded-box">
                    <div class="stat-title">Prevailing Sentiment</div>
                    <div class="stat-value text-3xl">
                        if strings.ToLower(prevailingSentiment) == "positive" {
                            <span class="text-success">😊 Positive</span>
                        } else if strings.ToLower(prevailingSentiment) == "negative" {
                            <span class="text-error">😔 Negative</span>
                        } else if strings.ToLower(prevailingSentiment) == "neutral" {
                            <span class="text-info">😐 Neutral</span>
                        } else {
                            <span>{ prevailingSentiment }</span>
                        }
                    </div>
                </div>
                
                <div class="stat bg-base-200 rounded-box">
                    <div class="stat-title">Average Confidence</div>
                    <div class="stat-value text-3xl">{ fmt.Sprintf("%.1f%%", averageConfidenceScore*100) }</div>
                    <div class="stat-desc">
                        <progress class="progress progress-primary w-full" value={ fmt.Sprintf("%.0f", averageConfidenceScore*100) } max="100"></progress>
                    </div>
                </div>
            </div>
            
            <div class="divider">Individual Post Sentiments</div>
            
            <div class="space-y-3">
                for i, sentiment := range allSentiments {
                    <div class="flex items-center gap-3 p-3 bg-base-200 rounded-lg">
                        <span class="font-semibold text-gray-600">Post { fmt.Sprintf("%d", i+1) }:</span>
                        if strings.ToLower(sentiment) == "positive" {
                            <span class="badge badge-success gap-2">
                                😊 Positive
                            </span>
                        } else if strings.ToLower(sentiment) == "negative" {
                            <span class="badge badge-error gap-2">
                                😔 Negative
                            </span>
                        } else if strings.ToLower(sentiment) == "neutral" {
                            <span class="badge badge-info gap-2">
                                😐 Neutral
                            </span>
                        } else {
                            <span class="badge badge-ghost gap-2">
                                { sentiment }
                            </span>
                        }
                    </div>
                }
            </div>
            
            <div class="card-actions justify-end mt-6">
                <button 
                    class="btn btn-primary"
                    onclick="document.getElementById('sentimentAnalysis').innerHTML = ''; document.querySelector('input[name=userHandle]').value = '';"
                >
                    Analyze Another User
                </button>
            </div>
        </div>
    </div>
}